{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Ephect phpx",
	"fileTypes": ["phpx", "ephect.php", "phtml"],
	"patterns": [
		{
			"include": "#keywords"
		},
		{
			"include": "#percent-variables"  
		},
		{
			"include": "#liquid-double-braces"
		},
		{
			"include": "#liquid-single-braces"
		},
		{
			"include": "#strings"
		},
		{
			"include": "source.php"
		}
	],
	"injections": {
		"string.unquoted.heredoc.php": {
			"patterns": [
				{
					"include": "#keywords"
				},
				{
					"include": "#percent-variables"
				},
				{
					"include": "#liquid-double-braces"
				},
				{
					"include": "#liquid-single-braces"
				}
			]
		}
	},
	"repository": {
		"keywords": {
			"patterns": [
				{
					"name": "keyword.control.phpx",
					"match": "@(if|else|elseif|while|for|foreach|break|continue|return|done)\\b"
				},
				{
					"name": "keyword.control.phpx",
					"match": "\\b(do|as)\\b"
				},
				{
					"name": "keyword.operator.phpx",
					"match": "\\b(in|instanceof)\\b"
				}
			]
		},
		"strings": {
			"name": "string.quoted.double.phpx",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.phpx",
					"match": "\\\\."
				}
			]
		},
		"percent-variables": {
			"name": "variable.parameter.global.phpx",
			"match": "%[a-zA-Z_][a-zA-Z0-9_]*\\b"
		},
		"liquid-double-braces": {
			"name": "meta.liquid.double-braces.phpx",
			"begin": "\\{\\{",
			"end": "\\}\\}",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.liquid.begin.phpx"
				}
			},
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.liquid.end.phpx"
				}
			},
			"patterns": [
				{
					"include": "#liquid-content"
				}
			]
		},
		"liquid-single-braces": {
			"name": "meta.liquid.single-braces.phpx",
			"begin": "\\{(?!\\{)",
			"end": "\\}(?!\\})",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.liquid.begin.phpx"
				}
			},
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.liquid.end.phpx"
				}
			},
			"patterns": [
				{
					"include": "#liquid-content"
				}
			]
		},
		"liquid-content": {
			"patterns": [
				{
					"name": "variable.parameter.liquid.phpx",
					"match": "%[a-zA-Z_][a-zA-Z0-9_]*\\b"
				},
				{
					"name": "variable.other.php.liquid.phpx",
					"match": "\\$[a-zA-Z_][a-zA-Z0-9_]*\\b"
				},
				{
					"name": "variable.other.liquid.phpx",
					"match": "\\b[a-zA-Z_][a-zA-Z0-9_]*(?:\\->[a-zA-Z_][a-zA-Z0-9_]*)*\\b"
				},
				{
					"name": "keyword.operator.liquid.phpx",
					"match": "\\||\\.|\\->|\\+|\\-|\\*|\\/|%|==|!=|<|>|<=|>=|and|or|not|&&|\\|\\||!|\\bin\\b|\\binstanceof\\b"
				},
				{
					"name": "keyword.control.liquid.phpx",
					"match": "\\bas\\b"
				},
				{
					"name": "constant.numeric.liquid.phpx",
					"match": "\\b\\d+(\\.\\d+)?\\b"
				},
				{
					"name": "string.quoted.single.liquid.phpx",
					"begin": "'",
					"end": "'",
					"patterns": [
						{
							"name": "constant.character.escape.liquid.phpx",
							"match": "\\\\."
						}
					]
				},
				{
					"name": "string.quoted.double.liquid.phpx",
					"begin": "\"",
					"end": "\"",
					"patterns": [
						{
							"name": "constant.character.escape.liquid.phpx",
							"match": "\\\\."
						}
					]
				},
				{
					"name": "punctuation.separator.liquid.phpx",
					"match": "[,:;()]"
				}
			]
		}
	},
	"scopeName": "source.ephect"
}